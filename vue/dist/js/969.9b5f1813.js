"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[969],{969:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var s=function(){var e=this,t=e._self._c;return t("div",["STUDENT"!==e.user.role?t("div",{staticClass:"search"},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入账号查询"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"info",plain:""},on:{click:function(t){return e.load(1)}}},[e._v("查询")]),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"warning",plain:""},on:{click:e.reset}},[e._v("重置")])],1):e._e(),t("div",{staticClass:"operation"},["ADMIN"===e.user.role||"STUDENT"===e.user.role?t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleAdd}},[e._v("新增")]):e._e(),"ADMIN"===e.user.role?t("el-button",{attrs:{type:"danger",plain:""},on:{click:e.delBatch}},[e._v("批量删除")]):e._e()],1),t("div",{staticClass:"table"},[t("el-table",{attrs:{data:e.tableData,stripe:""},on:{"selection-change":e.handleSelectionChange}},["ADMIN"===e.user.role?t("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}):e._e(),t("el-table-column",{attrs:{prop:"id",label:"序号",width:"70",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"stuId",label:"学生ID"}}),t("el-table-column",{attrs:{prop:"username",label:"用户名",width:"120"}}),t("el-table-column",{attrs:{prop:"name",label:"姓名"}}),t("el-table-column",{attrs:{prop:"className",label:"班级"}}),t("el-table-column",{attrs:{prop:"teacherName",label:"教师"}}),t("el-table-column",{attrs:{prop:"phone",label:"联系电话",width:"120"}}),t("el-table-column",{attrs:{prop:"enterpriseName",label:"单位名称",width:"120"}}),t("el-table-column",{attrs:{prop:"jobName",label:"岗位名称",width:"150"}}),t("el-table-column",{attrs:{prop:"beginTime",label:"开始时间",width:"120"}}),t("el-table-column",{attrs:{prop:"endTime",label:"结束时间",width:"100"}}),t("el-table-column",{attrs:{label:"实习状态",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{attrs:{filterable:"",placeholder:"请选择实习状态",disabled:"STUDENT"===e.user.role||1!==a.row.resumeStatus||"ENTERPRISE"===e.user.role},on:{change:function(t){return e.handleStatusChange(a.row)}},model:{value:a.row.status,callback:function(t){e.$set(a.row,"status",t)},expression:"scope.row.status"}},e._l(e.statusOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]}}])}),t("el-table-column",{attrs:{prop:"read_status",label:"阅读状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[2===a.row.readStatus?t("el-tag",{attrs:{type:"success"}},[e._v("已读")]):t("el-tag",{attrs:{type:"warning"}},[e._v("未读")])]}}])}),t("el-table-column",{attrs:{prop:"resume_status",label:"简历状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[1===a.row.resumeStatus?t("el-tag",{attrs:{type:"success"}},[e._v("已通过")]):e._e(),2===a.row.resumeStatus?t("el-tag",{attrs:{type:"danger"}},[e._v("未通过")]):e._e()]}}])}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"300"},scopedSlots:e._u([{key:"default",fn:function(a){return["ADMIN"===e.user.role||"STUDENT"===e.user.role?t("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]):e._e(),"ADMIN"===e.user.role?t("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(t){return e.del(a.row.id)}}},[e._v("删除")]):e._e(),"TEACHER"===e.user.role||"ADMIN"===e.user.role?t("el-button",{attrs:{size:"mini",plain:""},on:{click:function(t){return e.handleView(a.row)}}},[e._v("查看")]):e._e(),"STUDENT"!==e.user.role?t("el-button",{attrs:{size:"mini",plain:""},on:{click:function(t){return e.handleViewResume(a.row.stuId)}}},[e._v("查看简历")]):e._e()]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-sizes":[5,10,20],"page-size":e.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1),t("el-dialog",{attrs:{title:"实习信息",visible:e.fromVisible,width:"40%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(t){e.fromVisible=t}}},[t("el-form",{ref:"formRef",staticStyle:{"padding-right":"50px"},attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[t("el-form-item",{attrs:{label:"学生ID",prop:"stuId"}},[t("el-input",{attrs:{placeholder:"学生ID",disabled:"STUDENT"===e.user.role},model:{value:e.form.stuId,callback:function(t){e.$set(e.form,"stuId",t)},expression:"form.stuId"}})],1),t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("el-input",{attrs:{placeholder:"用户名",disabled:"STUDENT"===e.user.role},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),t("el-form-item",{attrs:{label:"姓名",prop:"name"}},[t("el-input",{attrs:{placeholder:"姓名",disabled:"STUDENT"===e.user.role},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"班级",prop:"classId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择班级",disabled:""},model:{value:e.form.classId,callback:function(t){e.$set(e.form,"classId",t)},expression:"form.classId"}},e._l(e.classData,(function(e){return t("el-option",{attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"教师",prop:"teacherId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择教师"},model:{value:e.form.teacherId,callback:function(t){e.$set(e.form,"teacherId",t)},expression:"form.teacherId"}},e._l(e.teacherData,(function(e){return t("el-option",{attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"联系电话",prop:"phone"}},[t("el-input",{attrs:{placeholder:"联系电话"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),t("el-form-item",{attrs:{label:"单位名称",prop:"enterpriseId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择单位"},on:{change:e.loadJobByEnterpriseId},model:{value:e.form.enterpriseId,callback:function(t){e.$set(e.form,"enterpriseId",t)},expression:"form.enterpriseId"}},e._l(e.enterpriseData,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"岗位名称",prop:"jobId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择岗位"},model:{value:e.form.jobId,callback:function(t){e.$set(e.form,"jobId",t)},expression:"form.jobId"}},e._l(e.jobData,(function(e){return t("el-option",{attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"开始时间",prop:"beginTime"}},[t("div",{staticClass:"block"},[t("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"开始时间","picker-options":e.pickerOptions},model:{value:e.form.beginTime,callback:function(t){e.$set(e.form,"beginTime",t)},expression:"form.beginTime"}})],1)]),t("el-form-item",{attrs:{label:"结束时间",prop:"endTime"}},[t("div",{staticClass:"block"},[t("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"结束时间","picker-options":e.pickerOptions},model:{value:e.form.endTime,callback:function(t){e.$set(e.form,"endTime",t)},expression:"form.endTime"}})],1)])],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.fromVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"简历信息",visible:e.ResumeFromVisible,width:"40%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(t){e.ResumeFromVisible=t}}},[t("el-form",{ref:"formRef",attrs:{"label-width":"100px",model:e.form,rules:e.rules}},[t("h2",[e._v("个人信息")]),t("el-form-item",{attrs:{label:"姓名",prop:"name"}},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"姓名"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"电话",prop:"tel"}},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"电话"},model:{value:e.form.tel,callback:function(t){e.$set(e.form,"tel",t)},expression:"form.tel"}})],1),t("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"邮箱"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),t("el-form-item",{attrs:{label:"现居城市",prop:"address"}},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"现居城市"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),t("el-form-item",{attrs:{label:"性别",prop:"gender"}},[t("el-select",{attrs:{placeholder:"请选择性别"},model:{value:e.form.gender,callback:function(t){e.$set(e.form,"gender",t)},expression:"form.gender"}},[t("el-option",{attrs:{label:"男",value:"男"}}),t("el-option",{attrs:{label:"女",value:"女"}})],1)],1),t("el-form-item",{attrs:{label:"当前状态",prop:"status"}},[t("el-select",{attrs:{placeholder:"请选择当前状态"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[t("el-option",{attrs:{label:"在职",value:"在职"}}),t("el-option",{attrs:{label:"离职",value:"离职"}}),t("el-option",{attrs:{label:"应届毕业生",value:"应届毕业生"}})],1)],1),t("h2",[e._v("求职意向")]),t("el-form-item",{attrs:{label:"意向城市",prop:"city"}},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"意向城市"},model:{value:e.form.city,callback:function(t){e.$set(e.form,"city",t)},expression:"form.city"}})],1),t("el-form-item",{attrs:{label:"期望职位",prop:"department"}},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"期望职位"},model:{value:e.form.department,callback:function(t){e.$set(e.form,"department",t)},expression:"form.department"}})],1),t("el-form-item",{attrs:{label:"期望薪资",prop:"salary"}},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"期望薪资"},model:{value:e.form.salary,callback:function(t){e.$set(e.form,"salary",t)},expression:"form.salary"}})],1),t("h2",[e._v("个人总结")]),t("el-form-item",{attrs:{label:"个人总结",prop:"person"}},[t("el-input",{attrs:{type:"textarea",placeholder:"个人总结"},model:{value:e.form.person,callback:function(t){e.$set(e.form,"person",t)},expression:"form.person"}})],1),t("h2",[e._v("教育背景")]),t("el-form-item",{attrs:{label:"教育背景",prop:"education"}},[t("el-input",{attrs:{type:"textarea",placeholder:"教育背景"},model:{value:e.form.education,callback:function(t){e.$set(e.form,"education",t)},expression:"form.education"}})],1),t("h2",[e._v("项目经历")]),t("el-form-item",{attrs:{label:"项目经历",prop:"project"}},[t("el-input",{attrs:{type:"textarea",placeholder:"项目经历"},model:{value:e.form.project,callback:function(t){e.$set(e.form,"project",t)},expression:"form.project"}})],1),t("h2",[e._v("技能及证书")]),t("el-form-item",{attrs:{label:"技能及证书",prop:"skills"}},[t("el-input",{attrs:{type:"textarea",placeholder:"技能及证书"},model:{value:e.form.skills,callback:function(t){e.$set(e.form,"skills",t)},expression:"form.skills"}})],1),t("h2",[e._v("荣誉奖项")]),t("el-form-item",{attrs:{label:"荣誉奖项",prop:"honor"}},[t("el-input",{attrs:{type:"textarea",placeholder:"荣誉奖项"},model:{value:e.form.honor,callback:function(t){e.$set(e.form,"honor",t)},expression:"form.honor"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},["ENTERPRISE"!==e.user.role?t("el-button",{on:{click:function(t){e.ResumeFromVisible=!1}}},[e._v("取 消")]):e._e(),"TEACHER"===e.user.role?t("el-button",{attrs:{type:"primary"},on:{click:e.updateResume}},[e._v("优 化")]):e._e(),"ENTERPRISE"===e.user.role?t("el-button",{attrs:{type:"success"},on:{click:function(t){return e.ResumeStatus(e.form.studentId,1)}}},[e._v("通 过")]):e._e(),"ENTERPRISE"===e.user.role?t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.ResumeStatus(e.form.studentId,2)}}},[e._v("拒 绝")]):e._e()],1)],1),t("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,width:"30%","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("span",[e._v("您还没有简历，请新建后再申请岗位。")])])],1)},l=[],r={name:"Apply",data(){return{tableData:[],pageNum:1,pageSize:6,total:0,username:null,fromVisible:!1,ResumeFromVisible:!1,dialogVisible:!1,form:{},user:JSON.parse(localStorage.getItem("xm-user")||"{}"),rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"}]},ids:[],classData:[],teacherData:[],enterpriseData:[],jobData:[],timeDate:"",pickerOptions:{disabledDate(e){return e.getTime()<Date.now()-864e5}},statusOptions:[{value:"未实习",label:"未实习"},{value:"实习中",label:"实习中"},{value:"实习结束",label:"实习结束"}]}},created(){this.load(1),this.loadTeachers(),this.loadClasses(),this.loadEnterprise(),this.loadJob()},methods:{loadClasses(){this.$request.get("/classes/selectAll").then((e=>{"200"===e.code?this.classData=e.data:this.$message.error(e.msg)}))},loadEnterprise(){this.$request.get("/enterprise/selectAll").then((e=>{"200"===e.code?this.enterpriseData=e.data:this.$message.error(e.msg)}))},loadTeachers(){this.$request.get("/teacher/selectAll").then((e=>{"200"===e.code?this.teacherData=e.data:this.$message.error(e.msg)}))},loadJobByEnterpriseId(e){this.$request.get(`/job/selectEnterpriseJob/${e}`).then((e=>{"200"===e.code?(console.log(e.data),this.jobData=e.data):this.$message.error(e.msg)}))},handleAdd(){this.form={},"STUDENT"===this.user.role&&(this.form.stuId=this.user.id,this.form.username=this.user.username,this.form.classId=this.user.classId,this.form.name=this.user.name),"STUDENT"===this.user.role&&this.$request.get(`/resume/selectByStudentId/${this.user.id}`).then((e=>{e.data?this.fromVisible=!0:this.dialogVisible=!0}))},handleEdit(e){this.form=JSON.parse(JSON.stringify(e)),this.fromVisible=!0},handleViewResume(e){this.$request.get(`/resume/selectByStudentId/${e}`).then((e=>{e&&e.data?(this.form=e.data,this.ResumeFromVisible=!0):this.$message.warning("该学生暂无简历信息")}))},updateResume(){this.$request({url:"/resume/updateByStudentId",method:"PUT",data:this.form}).then((e=>{"200"===e.code?(this.$message.success("简历优化成功"),this.load(1),this.ResumeFromVisible=!1):this.$message.error(e.msg)}))},ResumeStatus(e,t){1===t?this.$confirm("确定通过该简历吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.updateResumeStatus(e,t)})).catch((()=>{this.$message({type:"info",message:"已取消"})})):2===t&&this.$confirm("确定拒绝该简历吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.updateResumeStatus(e,t)})).catch((()=>{this.$message({type:"info",message:"已取消"})}))},updateResumeStatus(e,t){this.$request.put("/apply/updateResumeStatus/"+e+"/"+t).then((e=>{this.load(1),this.ResumeFromVisible=!1})).catch((e=>{console.error("更新简历状态失败:",e)}))},save(){this.$refs.formRef.validate((e=>{e&&(2===this.form.readStatus&&"STUDENT"===this.user.role&&(this.form.readStatus=1),this.$request({url:this.form.id?"/apply/update":"/apply/add",method:this.form.id?"PUT":"POST",data:this.form}).then((e=>{"200"===e.code?(this.$message.success("保存成功"),this.load(1),this.fromVisible=!1):this.$message.error(e.msg)})),this.$request.post("/userActions/add",{userId:this.user.id,jobId:this.form.jobId,actionType:"APPLY"}))}))},del(e){this.$confirm("您确定删除吗？","确认删除",{type:"warning"}).then((t=>{this.$request.delete("/apply/delete/"+e).then((e=>{"200"===e.code?(this.$message.success("操作成功"),this.load(1)):this.$message.error(e.msg)}))})).catch((()=>{}))},handleSelectionChange(e){this.ids=e.map((e=>e.id))},delBatch(){this.ids.length?this.$confirm("您确定批量删除这些数据吗？","确认删除",{type:"warning"}).then((e=>{this.$request.delete("/apply/delete/batch",{data:this.ids}).then((e=>{"200"===e.code?(this.$message.success("操作成功"),this.load(1)):this.$message.error(e.msg)}))})).catch((()=>{})):this.$message.warning("请选择数据")},load(e){e&&(this.pageNum=e),"ENTERPRISE"===this.user.role?this.$request.get("/apply/selectEnterprise",{params:{pageNum:this.pageNum,pageSize:this.pageSize,username:this.username,enterpriseId:this.user.id}}).then((e=>{this.tableData=e.data?.list,this.total=e.data?.total})):"TEACHER"===this.user.role?this.$request.get("/apply/selectByTeacher",{params:{pageNum:this.pageNum,pageSize:this.pageSize,username:this.username,teacherId:this.user.id}}).then((e=>{this.tableData=e.data?.list,this.total=e.data?.total})):"STUDENT"===this.user.role?this.$request.get("/apply/selectByStudent",{params:{pageNum:this.pageNum,pageSize:this.pageSize,username:this.username,stuId:this.user.id}}).then((e=>{this.tableData=e.data?.list,this.total=e.data?.total})):this.$request.get("/apply/selectPage",{params:{pageNum:this.pageNum,pageSize:this.pageSize,username:this.username}}).then((e=>{this.tableData=e.data?.list,this.total=e.data?.total}))},reset(){this.username=null,this.load(1)},handleCurrentChange(e){this.load(e)},handleAvatarSuccess(e,t,a){this.form.avatar=e.data},handleStatusChange(e){e.resumeStatus&&1!==e.resumeStatus?this.$message.warning("未通过简历审核，请修改实习申请信息"):this.$request({url:"/apply/updateStatus",method:"PUT",data:{id:e.id,status:e.status}}).then((t=>{"200"===t.code?this.$message.success(`状态已更新为：${e.status}`):this.$message.error(t.msg)}))},handleView(e){1===e.readStatus&&(e.readStatus=2,this.updateReadStatus(e).then((()=>{this.$message.success("读取状态更新成功")})).catch((e=>{this.$message.error("读取状态更新失败")}))),this.form=JSON.parse(JSON.stringify(e)),this.fromVisible=!0},updateReadStatus(e){return new Promise(((t,a)=>{this.$request({url:"/apply/updateReadStatus",method:"PUT",data:{id:e.id,readStatus:e.readStatus}}).then((e=>{"200"===e.code?t():a()})).catch((e=>{a()}))}))}}},o=r,i=a(3736),n=(0,i.Z)(o,s,l,!1,null,"be172412",null),u=n.exports}}]);
//# sourceMappingURL=969.9b5f1813.js.map